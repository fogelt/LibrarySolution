@using Library.Core.Models

<div class="px-1">
  <table class="text-white align-middle bg-transparent"
         style="border-separate: separate; border-spacing: 0 10px; border-collapse: separate; width: 100%;">
    <thead>
      <tr class="opacity-50 small text-uppercase text-white" style="letter-spacing: 0.15em; font-size: 0.7rem;">
        <th class="ps-4">Member</th>
        <th>Item Details</th>
        <th>Timeline</th>
        <th>Status</th>
        <th class="text-end pe-4">Actions</th>
      </tr>
    </thead>
    <tbody class="text-white">
      @if (Loans == null || !Loans.Any())
      {
        <tr>
          <td colspan="5" class="text-center py-5">
            <div class="glass-card p-5 opacity-50">
              <i class="bi bi-inbox fs-2 d-block mb-2 text-white"></i>
              <span class="text-uppercase small text-white" style="letter-spacing: 0.1em;">No active loans records</span>
            </div>
          </td>
        </tr>
      }
      else
      {
        @foreach (Loan loan in Loans)
        {
          <tr class="glass-card shadow-sm text-white">
            <td class="py-3 ps-4 text-white" style="border-radius: 12px 0 0 12px;">
              <div class="fw-bold text-white" style="font-size: 0.9rem;">@loan.Member?.Name</div>
              <div class="opacity-50 text-uppercase text-white" style="font-size: 0.6rem; letter-spacing: 0.05em;">
                @loan.MemberId
              </div>
            </td>

            <td class="text-white">
              <div class="fw-semibold text-white" style="font-size: 0.85rem;">@loan.Item?.Title</div>
              <div class="opacity-50 text-uppercase" style="font-size: 0.6rem;">
                @loan.Item?.GetType().Name
              </div>
            </td>

            <td class="text-white">
              <div class="d-flex flex-column">
                <span class="small opacity-75"><i class="bi bi-calendar-check me-2"></i>@loan.LoanDate.ToString("MMM             dd")</span>
                <span class="small @(loan.IsOverdue ? "text-danger" : "opacity-50")">
                  <i class="bi bi-calendar-x me-2"></i>@loan.DueDate.ToString("MMM dd")
                </span>
              </div>
            </td>

            <td>
              @if (loan.IsOverdue)
              {
                <span class="badge bg-danger bg-opacity-10 text-danger border border-danger border-opacity-25 px-3 py-1"
                      style="font-size: 0.6rem; letter-spacing: 0.05em;">OVERDUE</span>
              }
              @if (loan.IsReturned)
              {
                <span class="badge bg-secondary bg-opacity-10 text-secondary border border-secondary border-opacity-25 px-3 py-1"
                      style="font-size: 0.6rem; letter-spacing: 0.05em;">RETURNED</span>
              }
              @if (!loan.IsReturned && !loan.IsOverdue)
              {
                <span class="badge bg-success bg-opacity-10 text-success border border-success border-opacity-25 px-3 py-1"
                      style="font-size: 0.6rem; letter-spacing: 0.05em;">ACTIVE</span>
              }
            </td>
              <td class="text-end pe-4" style="border-radius: 0 12px 12px 0;">
                @if (!loan.IsReturned)
                {
                <button class="btn btn-sm glass-card border-white border-opacity-10 text-white px-3 py-2 hover-opacity-100"
                @onclick="() => OnReturnItem.InvokeAsync(loan.Id)">
                  <i class="bi bi-arrow-return-left me-1 opacity-50"></i>
                  <span class="small text-uppercase fw-bold" style="font-size: 0.65rem;">Return</span>
                </button>
                  }
              </td>
          </tr>
        }
      }
    </tbody>
  </table>
</div>

@code {
  [Parameter] public List<Loan>? Loans { get; set; }
  [Parameter] public EventCallback<string> OnReturnItem { get; set; }
}